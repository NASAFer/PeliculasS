<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Pel√≠culas</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
  
<body>
  <!-- Bot√≥n regresar -->
  <a href="/" class="regresar-btn">
    <button>‚Üê Regresar</button>
  </a>

  <!-- Bot√≥n agregar pel√≠cula -->
  <a href="/peliculas/agregar" class="agregar-btn">
    <button>+ Agregar Pel√≠cula</button>
  </a>

  <h1>Pel√≠culas (modo administrador)</h1>

  <!-- üîç Formulario de b√∫squeda -->
  <form action="/buscar" method="GET">
    <input type="text" name="q" placeholder="Buscar pel√≠culas..." value="<%= typeof query !== 'undefined' ? query : '' %>" required>
    <button type="submit">Buscar</button>
  </form>

  <div class="lista-peliculas">
    <% peliculas.forEach(pelicula => { %>
      <div class="pelicula">
        <h3><%= pelicula.T√≠tulo %></h3>
        <p><strong>Actores:</strong> <%= pelicula.Actores.join(", ") %></p>
        <p><strong>Categor√≠a:</strong> <%= pelicula.Categor√≠a %></p>
        <p><strong>A√±o:</strong> <%= pelicula.A√±o %></p>
        <p><strong>Sinopsis:</strong> <%= pelicula.Sinopsis %></p>
        <p><strong>Subido por:</strong> <%= pelicula.usuario ? pelicula.usuario.username : 'Desconocido' %></p>

        
  
       
  
        <% if (user && (user._id.equals(pelicula.usuario._id) || user.esAdmin)) { %>
          <div class="acciones">
            <a href="/peliculas/<%= pelicula._id %>/editar" class="editar-btn">Editar</a>
            <form action="/peliculas/<%= pelicula._id %>/eliminar" method="POST" style="display:inline;">
              <button type="submit" class="eliminar-btn" onclick="return confirm('¬øEst√°s seguro de que deseas eliminar esta pel√≠cula?')">Eliminar</button>
            </form>
          </div>
        <% } %>
      </div>
    <% }) %>
  </div>
  